---
apiVersion: operator.knative.dev/v1beta1
kind: KnativeServing
metadata:
  name: knative-serving
spec:
  version: 1.10.0
  additionalManifests:
  - URL: https://github.com/knative-sandbox/net-certmanager/releases/download/knative-v1.10.0/net-certmanager.yaml
  config:
    certmanager:
      issuerRef: |
        kind: ClusterIssuer
        name: letsencrypt-cloudflare
    domain:
      ${KNATIVE_DOMAIN}: ""
    network:
      auto-tls: Enabled
      http-protocol: Redirected
      namespace-wildcard-cert-selector: |
        {"matchExpressions": [
          {
            "key":"networking.knative.dev/disableWildcardCert",
            "operator": "NotIn",
            "values":["true"]
          }
        ]}
  ingress:
    istio:
      enabled: true
